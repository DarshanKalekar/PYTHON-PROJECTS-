import uuid

class Train:
    def __init__(self, train_no, name, source, destination, seats):
        self.train_no = train_no
        self.name = name
        self.source = source
        self.destination = destination
        self.seats = seats

class Ticket:
    def __init__(self, passenger_name, train):
        self.ticket_id = str(uuid.uuid4())[:8]
        self.passenger_name = passenger_name
        self.train = train

class RailwaySystem:
    def __init__(self):
        self.trains = []
        self.bookings = {}

    def add_train(self, train):
        self.trains.append(train)

    def show_trains(self):
        print("\nAvailable Trains:")
        for train in self.trains:
            print(f"{train.train_no} | {train.name} | {train.source} -> {train.destination} | Seats: {train.seats}")

    def book_ticket(self, train_no, passenger_name):
        for train in self.trains:
            if train.train_no == train_no:
                if train.seats > 0:
                    ticket = Ticket(passenger_name, train)
                    train.seats -= 1
                    self.bookings[ticket.ticket_id] = ticket
                    print(f"\nTicket Booked Successfully!")
                    print(f"Ticket ID: {ticket.ticket_id}")
                    return
                else:
                    print("\nNo seats available.")
                    return
        print("\nTrain not found.")

    def cancel_ticket(self, ticket_id):
        if ticket_id in self.bookings:
            ticket = self.bookings.pop(ticket_id)
            ticket.train.seats += 1
            print("\nTicket Cancelled Successfully.")
        else:
            print("\nInvalid Ticket ID.")

    def show_bookings(self):
        print("\nYour Bookings:")
        if not self.bookings:
            print("No bookings found.")
            return
        for ticket_id, ticket in self.bookings.items():
            print(f"{ticket_id} | {ticket.passenger_name} | {ticket.train.name}")

def main():
    system = RailwaySystem()

    # Add sample trains
    system.add_train(Train(101, "Express A", "Delhi", "Mumbai", 5))
    system.add_train(Train(102, "Express B", "Chennai", "Bangalore", 3))
    system.add_train(Train(103, "Express C", "Kolkata", "Patna", 2))

    while True:
        print("\n--- Railway Ticket System ---")
        print("1. Show Trains")
        print("2. Book Ticket")
        print("3. Cancel Ticket")
        print("4. View Bookings")
        print("5. Exit")

        choice = input("Enter choice: ")

        if choice == "1":
            system.show_trains()

        elif choice == "2":
            train_no = int(input("Enter Train Number: "))
            name = input("Enter Passenger Name: ")
            system.book_ticket(train_no, name)

        elif choice == "3":
            ticket_id = input("Enter Ticket ID: ")
            system.cancel_ticket(ticket_id)

        elif choice == "4":
            system.show_bookings()

        elif choice == "5":
            print("Thank you for using Railway System!")
            break

        else:
            print("Invalid choice. Try again.")

if __name__ == "__main__":
    main()
